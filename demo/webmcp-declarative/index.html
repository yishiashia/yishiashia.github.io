<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼æ¥­è¨‚ä¾¿ç•¶ç³»çµ± (WebMCP Declarative API Demo)</title>
    <!-- å¼•å…¥ @mcp-b/global polyfill ä»¥ä¾¿åœ¨ä¸æ”¯æ´çš„ç’°å¢ƒä¸­æ¨¡æ“¬ -->
    <script src="https://cdn.jsdelivr.net/npm/@mcp-b/global@latest/dist/browser.js"></script>
    <style>
        :root {
            --primary-color: #4a90e2;
            --bg-color: #f5f7fa;
            --card-bg: #ffffff;
            --text-color: #333333;
            --border-color: #e1e4e8;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
        }

        .description {
            background-color: #e8f4fd;
            border-left: 4px solid var(--primary-color);
            padding: 1rem;
            margin-bottom: 2rem;
            border-radius: 0 4px 4px 0;
        }

        .card {
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        input[type="text"],
        select,
        textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 1rem;
            box-sizing: border-box;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .checkbox-group input {
            width: auto;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            transition: background-color 0.2s;
        }

        button:hover {
            background-color: #357abd;
        }

        button.agent-btn {
            background-color: #10b981;
            margin-top: 1rem;
        }

        button.agent-btn:hover {
            background-color: #059669;
        }

        #resultBox {
            display: none;
            margin-top: 1.5rem;
            padding: 1rem;
            background-color: #d1fae5;
            border: 1px solid #34d399;
            border-radius: 4px;
            color: #065f46;
        }

        .code-block {
            background-color: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 4px;
            font-family: monospace;
            overflow-x: auto;
            margin-bottom: 1rem;
        }
    </style>
</head>

<body>

    <h1>ğŸ± ä¼æ¥­è¨‚ä¾¿ç•¶ç³»çµ±</h1>

    <div class="description">
        <p>é€™æ˜¯ä¸€å€‹å±•ç¤º <strong>WebMCP Declarative API</strong> çš„ç¯„ä¾‹ç¶²é ã€‚</p>
        <p>ä¸‹æ–¹çš„è¡¨å–®é€é HTML å±¬æ€§ <code>toolname="orderLunch"</code> èˆ‡ <code>tooldescription="..."</code>ï¼Œå°‡ä¸€å€‹æ¨™æº–çš„ç¶²é è¡¨å–®è½‰åŒ–ç‚º AI
            Agent å¯ç›´æ¥è¾¨è­˜èˆ‡æ“ä½œçš„å·¥å…·ã€‚æ‚¨å¯ä»¥ä½¿ç”¨äººé¡æ–¹å¼æ‰‹å‹•å¡«å¯«é€å‡ºï¼Œæˆ–é»æ“Šã€Œæ¨¡æ“¬ Agent å‘¼å«ã€è§€å¯Ÿæ•ˆæœã€‚</p>
    </div>

    <div class="card">
        <!-- WebMCP Declarative API: é—œéµåœ¨æ–¼ toolname å’Œ tooldescription å±¬æ€§ -->
        <form id="lunchForm" toolname="orderLunch"
            tooldescription="Submit a lunch order for an employee. Contains information like name, department, meal type, spicy preference, and notes.">

            <div class="form-group">
                <label for="name">è¨‚è³¼äººå§“å (Name)</label>
                <input type="text" id="name" name="name" required placeholder="è«‹è¼¸å…¥å§“å">
            </div>

            <div class="form-group">
                <label for="department">æ‰€å±¬éƒ¨é–€ (Department)</label>
                <select id="department" name="department" required>
                    <option value="">è«‹é¸æ“‡éƒ¨é–€</option>
                    <option value="hr">äººåŠ›è³‡æºéƒ¨ (HR)</option>
                    <option value="rd">ç ”ç™¼éƒ¨ (R&D)</option>
                    <option value="sales">æ¥­å‹™éƒ¨ (Sales)</option>
                    <option value="marketing">è¡ŒéŠ·éƒ¨ (Marketing)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="meal_type">é¤é»ç¨®é¡ (Meal Type)</label>
                <select id="meal_type" name="meal_type" required>
                    <option value="">è«‹é¸æ“‡é¤é»</option>
                    <option value="pork_ribs">æ‹›ç‰Œæ’éª¨é£¯</option>
                    <option value="chicken_leg">é¦™è„†é›è…¿é£¯</option>
                    <option value="fish">ç…§ç‡’é¯–é­šé£¯</option>
                    <option value="vegetarian">å¥åº·ç´ é£Ÿé¤ (è›‹å¥¶ç´ )</option>
                </select>
            </div>

            <div class="form-group checkbox-group">
                <input type="checkbox" id="spicy" name="spicy" value="true">
                <label for="spicy" style="margin: 0;">æ˜¯å¦åŠ è¾£ï¼Ÿ(Spicy)</label>
            </div>

            <div class="form-group">
                <label for="notes">ç‰¹æ®Šéœ€æ±‚ (Notes)</label>
                <textarea id="notes" name="notes" rows="3" placeholder="ä¾‹å¦‚ï¼šé£¯å°‘ã€ä¸è¦é’æ¤’..."></textarea>
            </div>

            <button type="submit" id="humanSubmitBtn">ğŸ™‹â€â™‚ï¸ ä¸€èˆ¬æäº¤è¡¨å–®</button>
        </form>

        <hr style="margin: 2rem 0; border: none; border-top: 1px dashed var(--border-color);">

        <h3>ğŸ¤– æ¨¡æ“¬ Agent æ“ä½œ</h3>
        <p style="font-size: 0.9rem; color: #666;">Agent è®€å–è¡¨å–® Schema å¾Œï¼Œæœƒè‡ªå‹•å¡«å…¥è³‡æ–™ä¸¦å‘¼å«è¡¨å–®çš„ <code>requestSubmit()</code>ï¼š</p>
        <div class="code-block" id="agentDataPreview">
            {
            "name": "AI æ¸¬è©¦å“¡",
            "department": "rd",
            "meal_type": "chicken_leg",
            "spicy": "true",
            "notes": "é£¯å°‘"
            }
        </div>
        <button type="button" class="agent-btn" id="agentSubmitBtn">ğŸ¤– æ¨¡æ“¬ Agent å¡«å…¥è³‡æ–™ä¸¦é€å‡º</button>

        <div id="resultBox">
            <strong>âœ… è¨‚è³¼æˆåŠŸï¼</strong><br>
            æ”¶åˆ°ä¾†è‡ª <span id="resName"></span> (<span id="resDept"></span>) çš„è¨‚å–®ã€‚<br>
            é¤é»ï¼š<span id="resMeal"></span> <span id="resSpicy"></span><br>
            å‚™è¨»ï¼š<span id="resNotes"></span>
        </div>
    </div>

    <script>
        const form = document.getElementById('lunchForm');
        const resultBox = document.getElementById('resultBox');

        // æ””æˆªè¡¨å–®é€å‡ºäº‹ä»¶ï¼Œé˜²æ­¢ç•«é¢è·³è½‰ï¼Œä¸¦é¡¯ç¤ºçµæœ
        form.addEventListener('submit', (e) => {
            e.preventDefault();

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());

            document.getElementById('resName').textContent = data.name;

            const deptMap = { 'hr': 'äººåŠ›è³‡æºéƒ¨', 'rd': 'ç ”ç™¼éƒ¨', 'sales': 'æ¥­å‹™éƒ¨', 'marketing': 'è¡ŒéŠ·éƒ¨' };
            document.getElementById('resDept').textContent = deptMap[data.department] || data.department;

            const mealMap = { 'pork_ribs': 'æ‹›ç‰Œæ’éª¨é£¯', 'chicken_leg': 'é¦™è„†é›è…¿é£¯', 'fish': 'ç…§ç‡’é¯–é­šé£¯', 'vegetarian': 'å¥åº·ç´ é£Ÿé¤' };
            document.getElementById('resMeal').textContent = mealMap[data.meal_type] || data.meal_type;

            document.getElementById('resSpicy').textContent = data.spicy ? '(ğŸŒ¶ï¸ åŠ è¾£)' : '';
            document.getElementById('resNotes').textContent = data.notes || 'ç„¡';

            resultBox.style.display = 'block';

            // 3ç§’å¾Œéš±è—çµæœ
            setTimeout(() => {
                resultBox.style.display = 'none';
                form.reset();
            }, 5000);
        });

        // æ¨¡æ“¬ Agent æ“ä½œè¡Œç‚º
        document.getElementById('agentSubmitBtn').addEventListener('click', () => {
            // 1. Agent å¡«å…¥æ¨è«–å¥½çš„è³‡æ–™
            const agentData = {
                name: "AI æ¸¬è©¦å“¡",
                department: "rd",
                meal_type: "chicken_leg",
                spicy: true,
                notes: "é£¯å°‘"
            };

            form.elements['name'].value = agentData.name;
            form.elements['department'].value = agentData.department;
            form.elements['meal_type'].value = agentData.meal_type;
            form.elements['spicy'].checked = agentData.spicy;
            form.elements['notes'].value = agentData.notes;

            // 2. Agent å‘¼å«é€å‡º
            // é€™è£¡åŠ ä¸€é»å»¶é²è®“ä½¿ç”¨è€…èƒ½çœ‹åˆ°è³‡æ–™å¡«å…¥çš„ç¬é–“
            setTimeout(() => {
                form.requestSubmit();
            }, 500);
        });
    </script>
</body>

</html>